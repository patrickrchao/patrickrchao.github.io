<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Patrick Chao" />

<meta name="date" content="2021-07-27" />

<title>Introduction to AdaPTGMM Package</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Introduction to <code>AdaPTGMM</code> Package</h1>
<h4 class="author">Patrick Chao</h4>
<h4 class="date">2021-07-27</h4>



<p>The <a href="https://arxiv.org/abs/2106.15812">AdaPTGMM</a> method is a flexible multiple testing algorithm that uses covariates to estimate the local false discovery rate with finite sample FDR control.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github(&quot;patrickrchao/AdaPTGMM&quot;)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AdaPTGMM)</span></code></pre></div>
<p>First, we generate some data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>(n,testing){</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  expit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>x))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  pi1 <span class="ot">&lt;-</span> <span class="fu">expit</span>(<span class="dv">2</span><span class="sc">*</span>(x<span class="dv">-1</span>))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  H <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">*</span> (<span class="fu">runif</span>(n) <span class="sc">&lt;</span> pi1)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> H <span class="sc">*</span> <span class="fu">rlogis</span>(n, <span class="at">location=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">scale=</span><span class="dv">1</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span>theta)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(testing <span class="sc">==</span> <span class="st">&quot;one_sided&quot;</span>){</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    pvals <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(testing <span class="sc">==</span> <span class="st">&quot;two_sided&quot;</span>){</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    pvals <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="fu">abs</span>(z), <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">z=</span>z,<span class="at">pvals=</span>pvals))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Two sided testing</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">generate_data</span>(<span class="dv">3000</span>,<span class="st">&quot;two_sided&quot;</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> data<span class="sc">$</span>x</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>pvals <span class="ot">&lt;-</span> data<span class="sc">$</span>pvals</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> data<span class="sc">$</span>z</span></code></pre></div>
<p>The AdaPTGMM package performs automatic model selection over the number of mixture components and a list of candidate models (or featurization).</p>
<ul>
<li><strong>Featurization</strong>: We may specify a featurization for the model in the <code>beta_formulas</code> input. Here we consider a spline basis with 2-4 degrees of freedom.</li>
<li><strong>Mixture Components</strong>: We may specify the number of mixture components in our Gaussian mixture model in the <code>nclasses</code> input. Here we consider 3-5 components. <!-- - **Model Selection**:  By default, we use AIC to select a featurization and the number of classes.--> <!--- - **Intercept Model**: By default, we include an intercept-only model in the featurization in case the -covariates turn out to be non-informative. This can be disabled by setting *intercept_model=FALSE*. --></li>
<li><strong>FDR levels</strong>: By default, AdaPTGMM produces a rejection set for every <span class="math inline">\(\alpha\)</span> level which can be reconstructed with the adjusted p-values (akin to <code>p.adjust</code>), the user may specify a vector of alpha levels in <code>alphas</code>. Here we choose 0.01, 0.05, 0.1, 0.2.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;splines&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span>  <span class="fu">paste</span>(<span class="st">&quot;splines::ns(x, df = &quot;</span>, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="st">&quot;)&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>nclasses <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>alphas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">adapt_gmm</span>(<span class="at">x=</span>x,<span class="at">pvals=</span>pvals, <span class="at">alphas=</span>alphas,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">beta_formulas =</span> formulas, <span class="at">nclasses=</span> nclasses)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model selection starting. Shrink the set of candidate models or reduce niter_fit/niter_ms/nfits if it is too time-consuming.</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span>                                                  <span class="er">|</span>   <span class="dv">0</span>%</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======</span>                                            <span class="er">|</span>  <span class="dv">12</span>%</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============</span>                                      <span class="er">|</span>  <span class="dv">25</span>%</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===================</span>                               <span class="er">|</span>  <span class="dv">38</span>%</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=========================</span>                         <span class="er">|</span>  <span class="dv">50</span>%</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===============================</span>                   <span class="er">|</span>  <span class="dv">62</span>%</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======================================</span>            <span class="er">|</span>  <span class="dv">75</span>%</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============================================</span>      <span class="er">|</span>  <span class="dv">88</span>%</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==================================================|</span> <span class="dv">100</span>%</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.2: FDPhat 0.1987, Number of Rej. 229</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.1: FDPhat 0.0988, Number of Rej. 162</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.05: FDPhat 0.0474, Number of Rej. 116</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.01: FDPhat 0.0091, Number of Rej. 55</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Complete.</span></span></code></pre></div>
<p>The arguments of the model are in <code>res$args</code>. The model selection chose a spline with 2 degrees of freedom and 4 Gaussian components.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selected beta formula from model selection</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Selected formula:&quot;</span>, <span class="fu">format</span>(res<span class="sc">$</span>args<span class="sc">$</span>beta_formula), <span class="at">collapse=</span><span class="st">&quot; &quot;</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Selected formula: class ~ splines::ns(x, df = 2)&quot;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Selected number of classes from model selection</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Selected number of classes:&quot;</span>, res<span class="sc">$</span>args<span class="sc">$</span>nclasses, <span class="at">collapse=</span><span class="st">&quot; &quot;</span>))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Selected number of classes: 4&quot;</span></span></code></pre></div>
<p>Instead, we may choose to model the <span class="math inline">\(z_i\)</span>’s. Since we are now inputting <span class="math inline">\(z_i\)</span>’s and using a two sided test, we need to specify that the testing procedure is two sided with <code>testing=&quot;two_sided&quot;</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>zres <span class="ot">&lt;-</span> <span class="fu">adapt_gmm</span>(<span class="at">x=</span>x,<span class="at">z=</span>z, <span class="at">alphas=</span>alphas, <span class="at">testing=</span><span class="st">&quot;two_sided&quot;</span>,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">beta_formulas =</span> formulas, <span class="at">nclasses=</span> nclasses)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model selection starting. Shrink the set of candidate models or reduce niter_fit/niter_ms/nfits if it is too time-consuming.</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span>                                                  <span class="er">|</span>   <span class="dv">0</span>%</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======</span>                                            <span class="er">|</span>  <span class="dv">12</span>%</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============</span>                                      <span class="er">|</span>  <span class="dv">25</span>%</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===================</span>                               <span class="er">|</span>  <span class="dv">38</span>%</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=========================</span>                         <span class="er">|</span>  <span class="dv">50</span>%</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===============================</span>                   <span class="er">|</span>  <span class="dv">62</span>%</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======================================</span>            <span class="er">|</span>  <span class="dv">75</span>%</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============================================</span>      <span class="er">|</span>  <span class="dv">88</span>%</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==================================================|</span> <span class="dv">100</span>%</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.2: FDPhat 0.1985, Number of Rej. 204</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.1: FDPhat 0.0987, Number of Rej. 157</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.05: FDPhat 0.05, Number of Rej. 130</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.01: FDPhat 0.0098, Number of Rej. 51</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Complete.</span></span></code></pre></div>
<p>We may also look at the fitted means and variances of the Gaussian components.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitted Gaussian means</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">&quot;Means:&quot;</span>, <span class="fu">sapply</span>(zres<span class="sc">$</span>params<span class="sc">$</span>mu,<span class="cf">function</span>(x) <span class="fu">round</span>(x,<span class="dv">2</span>))), <span class="at">collapse=</span><span class="st">&quot; &quot;</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Means: -0.42 0.07 0.21 0.52&quot;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitted Gaussian variances</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">&quot;Variances:&quot;</span>, <span class="fu">sapply</span>(zres<span class="sc">$</span>params<span class="sc">$</span>var,<span class="cf">function</span>(x) <span class="fu">round</span>(x,<span class="dv">2</span>))), <span class="at">collapse=</span><span class="st">&quot; &quot;</span>))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Variances: 0 0 0 4.49&quot;</span></span></code></pre></div>
<div id="masking" class="section level2">
<h2>Masking</h2>
<p>The masking function in AdaPTGMM is governed by three parameters, <span class="math inline">\(\alpha_m\)</span>, <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\zeta\)</span>, see our paper for more details. These three variables must satisfy <span class="math display">\[0&lt;\alpha_m\le \lambda \le \alpha\cdot\zeta + \lambda \le 1.\]</span> The value of <span class="math inline">\(\zeta\)</span> controls the minimum possible number of rejections. If the analyst expects a small number of rejections, i.e. <span class="math inline">\(&lt;20\)</span>, we recommend large <span class="math inline">\(\zeta\)</span>, for example 5-20.</p>
<p>If the user does not specify any values for <span class="math inline">\(\alpha_m\)</span>, <span class="math inline">\(\lambda\)</span>, and <span class="math inline">\(\zeta\)</span>, AdaPTGMM will choose default parameters, adapting to the total number of hypotheses. See our paper for more details.</p>
<p>We may input custom masking parameters. For the sake of example, we generate one sided p-values.</p>
<p><img src="data:image/png;base64,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VlbkYt4jgAACCCCAAAIIOAj4bhomr+cBffnll808ojqXaEmPChUqyF//+lcHXlYjgAACCCCAAAIIRAr4LgD1eh5QncD+yJEjjo82bdrIGWecEenJewQQQAABBBBAAAEHAd9dgmceUIczymoEEEAAAQQQQCDNBXwXgDIPaJp/oqgeAggggAACCCDgIOC7AFSPJ3Qe0I0bN4re/ejQoUNSt25d5gF1OOGsRgABBBBAAAEEUi3gywDURsvOzjbBqAakmrTv5tatW+3VPCOAAAIIIIAAAgikoYDvBiGpoQaZY8eONZPNf/PNN4Z16NChUqdOHdMCqi2hb7zxRhpyUyUEEEAAAQQQQAAB37WAavB5/vnni1561xbQp556Sh577DF5/PHH5frrr5dWrVrJpEmTzOtFixZJy5YtOcsIIIAAAggggAACaSTguxbQ0aNHi95yU++IpEFo586d5fbbb5f777/fBJ733HOPfP755yYQ1UnrSQgggAACCCCAAALpJeC7APSzzz4TnatTL7Pn5OTIkCFDjOiNN94YJtunTx9ZtWpV2DLeIIAAAggggAACCKRewHcBaLNmzWTZsmVBOZ0MXls6q1WrFlymL5YsWSK5ublhy3iDAAIIIIAAAgggkHoB3wWg2tKpfTx//etfy/fff28E77vvPsnLyzOvN23aJP379xe9paZOWk9CAAEEEEAAAQQQSC8B3wWgOgDp1VdfFb0Uv3r16iKakydPlmeffdYEoRqkkhBAAAEEEEAAAQTSS8B3o+CVr2vXrnL11VebeT8jOXv16iXa/1OnZCIhgAACCCCAAAIIpJ+ALwNQZczKyjKPSFL7Unzkct4jgAACCCCAAAIIpIeA7y7BpwcbtUAAAQQQQAABBBBIVIAANFE5tkMAAQQQQAABBBBISIAANCE2NkIAAQQQQAABBBBIVIAANFE5tkMAAQQQQAABBBBISIAANCE2NkIAAQQQQAABBBBIVIAANFE5tkMAAQQQQAABBBBISIAANCE2NkIAAQQQQAABBBBIVIAANFE5tkMAAQQQQAABBBBISIAANCE2NkIAAQQQQAABBBBIVIAANFE5tkMAAQQQQAABBBBISIAANCE2NkIAAQQQQAABBBBIVIAANFE5tkMAAQQQQAABBBBISIAANCE2NkIAAQQQQAABBBBIVIAANFE5tkMAAQQQQAABBBBI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" /><!-- --></p>
<p>In this dataset, we have some null p-values close to 1. Masking 0 and 1 to the same value will lead to inflated FDP estimates and lower power.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">adapt_gmm</span>(<span class="at">x=</span>x,<span class="at">z=</span>z, <span class="at">alphas=</span>alphas, <span class="at">testing=</span><span class="st">&quot;one_sided&quot;</span>,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">beta_formulas =</span> formulas, <span class="at">nclasses=</span> nclasses,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha_m =</span> <span class="fl">0.2</span>, <span class="at">lambda =</span> <span class="fl">0.4</span>, <span class="at">zeta =</span> <span class="dv">3</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model selection starting. Shrink the set of candidate models or reduce niter_fit/niter_ms/nfits if it is too time-consuming.</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span>                                                  <span class="er">|</span>   <span class="dv">0</span>%</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======</span>                                            <span class="er">|</span>  <span class="dv">12</span>%</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============</span>                                      <span class="er">|</span>  <span class="dv">25</span>%</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===================</span>                               <span class="er">|</span>  <span class="dv">38</span>%</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=========================</span>                         <span class="er">|</span>  <span class="dv">50</span>%</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===============================</span>                   <span class="er">|</span>  <span class="dv">62</span>%</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======================================</span>            <span class="er">|</span>  <span class="dv">75</span>%</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============================================</span>      <span class="er">|</span>  <span class="dv">88</span>%</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==================================================|</span> <span class="dv">100</span>%</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.2: FDPhat 0.1971, Number of Rej. 93</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.1: FDPhat 0.0976, Number of Rej. 41</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.05: FDPhat 0.0256, Number of Rej. 13</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.01: FDPhat 0.0256, Number of Rej. 0</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Complete.</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">adapt_gmm</span>(<span class="at">x=</span>x,<span class="at">z=</span>z, <span class="at">alphas=</span>alphas, <span class="at">testing=</span><span class="st">&quot;one_sided&quot;</span>,</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">beta_formulas =</span> formulas, <span class="at">nclasses=</span> nclasses,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha_m =</span> <span class="fl">0.2</span>, <span class="at">lambda =</span> <span class="fl">0.3</span>, <span class="at">zeta =</span> <span class="dv">3</span>)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model selection starting. Shrink the set of candidate models or reduce niter_fit/niter_ms/nfits if it is too time-consuming.</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span>                                                  <span class="er">|</span>   <span class="dv">0</span>%</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======</span>                                            <span class="er">|</span>  <span class="dv">12</span>%</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============</span>                                      <span class="er">|</span>  <span class="dv">25</span>%</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===================</span>                               <span class="er">|</span>  <span class="dv">38</span>%</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=========================</span>                         <span class="er">|</span>  <span class="dv">50</span>%</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===============================</span>                   <span class="er">|</span>  <span class="dv">62</span>%</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======================================</span>            <span class="er">|</span>  <span class="dv">75</span>%</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============================================</span>      <span class="er">|</span>  <span class="dv">88</span>%</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==================================================|</span> <span class="dv">100</span>%</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.2: FDPhat 0.1996, Number of Rej. 182</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.1: FDPhat 0.099, Number of Rej. 128</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.05: FDPhat 0.0495, Number of Rej. 101</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.01: FDPhat 0.0072, Number of Rej. 46</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Complete.</span></span></code></pre></div>
<p>We see that using a masking function with <span class="math inline">\(\nu= \alpha\cdot\zeta + \lambda=1\)</span> results in much lower power. For this reason, we recommend <span class="math inline">\(\alpha_m=\lambda\)</span> and <span class="math inline">\(\nu=0.9\)</span>.</p>
</div>
<div id="modeling-mixture-proportions" class="section level2">
<h2>Modeling Mixture Proportions</h2>
<p>AdaPTGMM models the mixture proportions with a blackbox classification model. We provide implementation of multinomial logistic regression, GAM, glmnet, and a neural network with a single hidden layer. The user may specify the model type with respectively <em>model_type=“nnet”</em>, <em>“mgcv”</em>, <em>“glmnet”</em>, and <em>“neural”</em>.</p>
<p>We may use a multinomial logistic regression model from <em>nnet::multinom</em>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>res_multinom <span class="ot">&lt;-</span> <span class="fu">adapt_gmm</span>(<span class="at">x=</span>x,<span class="at">z=</span>z, <span class="at">alphas=</span>alphas, <span class="at">testing=</span><span class="st">&quot;one_sided&quot;</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">beta_formulas =</span> formulas, <span class="at">model_type =</span> <span class="st">&quot;nnet&quot;</span>, <span class="at">nclasses=</span> nclasses)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model selection starting. Shrink the set of candidate models or reduce niter_fit/niter_ms/nfits if it is too time-consuming.</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span>                                                  <span class="er">|</span>   <span class="dv">0</span>%</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======</span>                                            <span class="er">|</span>  <span class="dv">12</span>%</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============</span>                                      <span class="er">|</span>  <span class="dv">25</span>%</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===================</span>                               <span class="er">|</span>  <span class="dv">38</span>%</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=========================</span>                         <span class="er">|</span>  <span class="dv">50</span>%</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===============================</span>                   <span class="er">|</span>  <span class="dv">62</span>%</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======================================</span>            <span class="er">|</span>  <span class="dv">75</span>%</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============================================</span>      <span class="er">|</span>  <span class="dv">88</span>%</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==================================================|</span> <span class="dv">100</span>%</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.2: FDPhat 0.1989, Number of Rej. 186</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.1: FDPhat 0.0977, Number of Rej. 133</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.05: FDPhat 0.0476, Number of Rej. 84</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.01: FDPhat 0.0102, Number of Rej. 0</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Complete.</span></span></code></pre></div>
<p>Alternatively, the user may construct use own beta model. AdaPTGMM accepts as input <strong>custom_beta_model</strong>, which must be a function that accepts a formula, dataset, and (optional) initialization parameters. This is a default template for writing a custom beta model. There are four key things that the function must do,</p>
<ol style="list-style-type: decimal">
<li>Fit the model using the formula, dataset, and weights per observation</li>
<li>Return fitted probabilities for each row in the dataset</li>
<li>Return the degrees of freedom of the model for model selection</li>
<li>(Optionally) Return model weights for initialization</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>custom_beta <span class="ot">&lt;-</span> <span class="cf">function</span>(formula, data, initialization){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">########################################################################</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># EDIT THIS SECTION to fit any desired model</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Formula, data, and weights for each observation in data$weights</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute:</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1. The fitted probabilities for the data</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. New model parameters for initialization (or leave as null if undesired)</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. Degrees of freedom for model (for model selection)</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">fit_model</span>(formula,data,<span class="at">params=</span>initialization,<span class="at">weights=</span>data<span class="sc">$</span>weights)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  fitted_probabilities <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  new_weights <span class="ot">&lt;-</span> model<span class="sc">$</span>weights</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> model<span class="sc">$</span>df</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="do">########################################################################</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>fitted_prob <span class="ot">&lt;-</span> fitted_probabilities</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>model_weights <span class="ot">&lt;-</span> new_weights</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>df <span class="ot">&lt;-</span> df</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here is an example of using a multinomial logistic regression model. To use a custom beta model, <code>model_type=&quot;custom&quot;</code> and <code>custom_beta_model=</code> the custom beta function.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>custom_multinom <span class="ot">&lt;-</span> <span class="cf">function</span>(formula, data, initialization){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">########################################################################</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># EDIT THIS SECTION to fit any desired model</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Formula, data, and weights for each observation in data$weights</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute:</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1. The fitted probabilities for the data</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. New model parameters for initialization (or leave as null if undesired)</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. Degrees of freedom for model (for model selection)</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>( initialization)){</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> nnet<span class="sc">::</span><span class="fu">multinom</span>(<span class="at">formula=</span>formula, <span class="at">data=</span>data, <span class="at">weights =</span> weights, <span class="at">trace =</span> F)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> nnet<span class="sc">::</span><span class="fu">multinom</span>(formula, data, <span class="at">weights =</span> weights, <span class="at">trace =</span> F,<span class="at">Wts=</span> initialization)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  fitted_probabilities <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  new_weights <span class="ot">&lt;-</span> model<span class="sc">$</span>wts</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">sum</span>(model<span class="sc">$</span>edf)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="do">########################################################################</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>fitted_prob <span class="ot">&lt;-</span> fitted_probabilities</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>model_weights <span class="ot">&lt;-</span> new_weights</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>df <span class="ot">&lt;-</span> df</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>res_custom <span class="ot">&lt;-</span> <span class="fu">adapt_gmm</span>(<span class="at">x=</span>x,<span class="at">z=</span>z, <span class="at">alphas=</span>alphas, <span class="at">testing=</span><span class="st">&quot;one_sided&quot;</span>,</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">beta_formulas =</span> formulas, <span class="at">nclasses=</span> nclasses,</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">model_type =</span> <span class="st">&quot;custom&quot;</span>, <span class="at">custom_beta_model =</span> custom_multinom)</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model selection starting. Shrink the set of candidate models or reduce niter_fit/niter_ms/nfits if it is too time-consuming.</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span>                                                  <span class="er">|</span>   <span class="dv">0</span>%</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======</span>                                            <span class="er">|</span>  <span class="dv">12</span>%</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============</span>                                      <span class="er">|</span>  <span class="dv">25</span>%</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===================</span>                               <span class="er">|</span>  <span class="dv">38</span>%</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=========================</span>                         <span class="er">|</span>  <span class="dv">50</span>%</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===============================</span>                   <span class="er">|</span>  <span class="dv">62</span>%</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======================================</span>            <span class="er">|</span>  <span class="dv">75</span>%</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============================================</span>      <span class="er">|</span>  <span class="dv">88</span>%</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==================================================|</span> <span class="dv">100</span>%</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.2: FDPhat 0.1989, Number of Rej. 186</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.1: FDPhat 0.0977, Number of Rej. 133</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.05: FDPhat 0.0476, Number of Rej. 84</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.01: FDPhat 0.0102, Number of Rej. 0</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Complete.</span></span></code></pre></div>
<p>We see that we obtain the same results as the default implementation of multinomial logistic regression.</p>
</div>
<div id="fast-version-of-adaptgmm" class="section level2">
<h2>Fast Version of AdaPTGMM</h2>
<p>If speed is a core concern, we recommend decreasing the number of iterations used in fitting the model and number of EM iterations, as well as using a simple <span class="math inline">\(\beta\)</span> model.</p>
<p>Overall Recommendations:</p>
<ul>
<li>Decrease number of candidate classes and the size of classes, here we set <code>nclasses=3</code>.</li>
<li>Decrease number of candidate featurizations, here we set <code>beta_formulas</code> to be a spline with 3 degrees of freedom.</li>
<li>Decrease number of EM outer loops, <code>nfits</code>. By default, <code>nfits=20</code>, we set it to be 3 here.</li>
<li>Decrease number of EM inner iterations, <code>niter_fit</code>. By default, <code>niter_fit=5</code>, we set it to be 2 here.</li>
<li>Decrease number of EM model selection steps, <code>niter_ms</code>. By default, <code>niter_fit=10</code>, we set it to be 5 here.</li>
<li>Optionally remove the intercept only model if the covariates are thought to be helpful.</li>
</ul>
<p>Here is a one example:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fast_res <span class="ot">&lt;-</span> <span class="fu">adapt_gmm</span>(<span class="at">x=</span>x,<span class="at">z=</span>z, <span class="at">alphas=</span>alphas, <span class="at">testing=</span><span class="st">&quot;one_sided&quot;</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">beta_formulas =</span> <span class="st">&quot;splines::ns(x, df=3)&quot;</span>, <span class="at">model_type =</span> <span class="st">&quot;nnet&quot;</span>, <span class="at">nclasses=</span> <span class="dv">4</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">nfits =</span> <span class="dv">5</span>, <span class="at">niter_fit=</span><span class="dv">2</span>, <span class="at">niter_ms =</span> <span class="dv">5</span>,<span class="at">intercept_model =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model selection starting. Shrink the set of candidate models or reduce niter_fit/niter_ms/nfits if it is too time-consuming.</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span>                                                  <span class="er">|</span>   <span class="dv">0</span>%</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                        </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==================================================|</span> <span class="dv">100</span>%</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.2: FDPhat 0.2, Number of Rej. 165</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.1: FDPhat 0.1, Number of Rej. 110</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.05: FDPhat 0.0461, Number of Rej. 76</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha = 0.01: FDPhat 0.01, Number of Rej. 50</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Complete.</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
